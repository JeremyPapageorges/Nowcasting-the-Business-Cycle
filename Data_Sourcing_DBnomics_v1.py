from dbnomics import fetch_series, fetch_series_by_api_link
import pandas as pd

def dbnomics_download():
    pmi_manufactoring = '{"_meta":{"args":{"align_periods":false,"dataset_code":"pmi","dimensions":{},"facets":true,"format":"json","limit":1000,"metadata":true,"observations":true,"offset":0,"provider_code":"ISM","q":"","series_code":null},"version":"22.1.17"},"dataset":{"code":"pmi","dimensions_codes_order":["frequency"],"dimensions_labels":{"frequency":"Frequency"},"dimensions_values_labels":{"frequency":{"M":"Monthly"}},"dir_hash":"743fb5c88fce171fb18ac0f6fe2cde1da3b3c3a3","indexed_at":"2024-10-02T03:27:11.943Z","name":"Manufacturing - PMI","nb_series":1,"next_release_at":"2024-11-01","provider_code":"ISM","provider_name":"Institute for Supply Management"},"errors":null,"provider":{"code":"ISM","indexed_at":"2024-10-29T02:06:02.741Z","name":"Institute for Supply Management","region":"US","slug":"ism","terms_of_use":"https:\/\/www.ismworld.org\/footer\/terms-of-use\/","website":"https:\/\/www.ismworld.org"},"series":{"docs":[{"@frequency":"monthly","dataset_code":"pmi","dataset_name":"Manufacturing - PMI","dimensions":{"frequency":"M"},"indexed_at":"2024-10-02T03:27:11.943Z","period":["2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02","2023-03","2023-04","2023-05","2023-06","2023-07","2023-08","2023-09","2023-10","2023-11","2023-12","2024-01","2024-02","2024-03","2024-04","2024-05","2024-06","2024-07","2024-08","2024-09"],"period_start_day":["2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01"],"provider_code":"ISM","series_code":"pm","series_name":"PMI","value":[43.1,52.2,53.7,55.6,55.7,58.8,57.7,60.5,58.7,60.9,63.7,60.6,61.6,60.9,59.9,59.7,60.5,60.8,60.6,58.8,57.6,58.4,57.0,55.9,56.1,53.1,52.7,52.9,51.0,50.0,49.0,48.4,47.4,47.7,46.5,47.0,46.6,46.4,46.5,47.6,48.6,46.9,46.6,47.1,49.1,47.8,50.3,49.2,48.7,48.5,46.8,47.2,47.2]}],"limit":1000,"num_found":1,"offset":0},"series_dimensions_facets":{"frequency":[{"code":"M","count":1}]}}'
    pmi_non_manufactoring = '{"_meta":{"args":{"align_periods":false,"dataset_code":"nm-pmi","dimensions":{},"facets":true,"format":"json","limit":1000,"metadata":true,"observations":true,"offset":0,"provider_code":"ISM","q":"","series_code":null},"version":"22.1.17"},"dataset":{"code":"nm-pmi","dimensions_codes_order":["frequency"],"dimensions_labels":{"frequency":"Frequency"},"dimensions_values_labels":{"frequency":{"M":"Monthly"}},"dir_hash":"cd00895cc31fea7bf5d486202c375ebb0a39436a","indexed_at":"2024-10-04T02:18:37.044Z","name":"Non manufacturing - PMI","nb_series":1,"next_release_at":"2024-11-05","provider_code":"ISM","provider_name":"Institute for Supply Management"},"errors":null,"provider":{"code":"ISM","indexed_at":"2024-10-29T02:06:02.741Z","name":"Institute for Supply Management","region":"US","slug":"ism","terms_of_use":"https:\/\/www.ismworld.org\/footer\/terms-of-use\/","website":"https:\/\/www.ismworld.org"},"series":{"docs":[{"@frequency":"monthly","dataset_code":"nm-pmi","dataset_name":"Non manufacturing - PMI","dimensions":{"frequency":"M"},"indexed_at":"2024-10-04T02:18:37.044Z","period":["2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02","2023-03","2023-04","2023-05","2023-06","2023-07","2023-08","2023-09","2023-10","2023-11","2023-12","2024-01","2024-02","2024-03","2024-04","2024-05","2024-06","2024-07","2024-08","2024-09"],"period_start_day":["2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01"],"provider_code":"ISM","series_code":"pm","series_name":"PMI","value":[45.4,56.5,56.6,57.2,57.2,56.2,56.8,57.7,58.7,55.3,63.7,62.7,63.2,60.7,64.1,62.2,62.6,66.7,68.4,62.3,59.9,57.2,58.4,57.5,56.4,56.0,56.4,56.1,55.9,54.5,55.5,49.2,55.2,55.0,51.2,52.3,51.0,53.6,52.8,54.1,53.4,51.9,52.5,50.5,53.4,52.6,51.4,49.4,53.8,48.8,51.4,51.5,54.9]}],"limit":1000,"num_found":1,"offset":0},"series_dimensions_facets":{"frequency":[{"code":"M","count":1}]}}'

    data = fetch_series_by_api_link(
        {"_meta":{"args":{"align_periods":false,"dataset_code":"pmi","dimensions":{},"facets":false,"format":"json","limit":1000,"metadata":true,"observations":true,"offset":0,"provider_code":"ISM","q":"","series_code":"pm"},"version":"22.1.17"},"dataset":{"code":"pmi","dimensions_codes_order":["frequency"],"dimensions_labels":{"frequency":"Frequency"},"dimensions_values_labels":{"frequency":{"M":"Monthly"}},"dir_hash":"743fb5c88fce171fb18ac0f6fe2cde1da3b3c3a3","indexed_at":"2024-10-02T03:27:11.943Z","name":"Manufacturing - PMI","nb_series":1,"next_release_at":"2024-11-01","provider_code":"ISM","provider_name":"Institute for Supply Management"},"errors":null,"provider":{"code":"ISM","indexed_at":"2024-10-29T02:06:02.741Z","name":"Institute for Supply Management","region":"US","slug":"ism","terms_of_use":"https:\/\/www.ismworld.org\/footer\/terms-of-use\/","website":"https:\/\/www.ismworld.org"},"series":{"docs":[{"@frequency":"monthly","dataset_code":"pmi","dataset_name":"Manufacturing - PMI","dimensions":{"frequency":"M"},"indexed_at":"2024-10-02T03:27:11.943Z","period":["2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02","2023-03","2023-04","2023-05","2023-06","2023-07","2023-08","2023-09","2023-10","2023-11","2023-12","2024-01","2024-02","2024-03","2024-04","2024-05","2024-06","2024-07","2024-08","2024-09"],"period_start_day":["2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01"],"provider_code":"ISM","series_code":"pm","series_name":"PMI","value":[43.1,52.2,53.7,55.6,55.7,58.8,57.7,60.5,58.7,60.9,63.7,60.6,61.6,60.9,59.9,59.7,60.5,60.8,60.6,58.8,57.6,58.4,57.0,55.9,56.1,53.1,52.7,52.9,51.0,50.0,49.0,48.4,47.4,47.7,46.5,47.0,46.6,46.4,46.5,47.6,48.6,46.9,46.6,47.1,49.1,47.8,50.3,49.2,48.7,48.5,46.8,47.2,47.2]}],"limit":1000,"num_found":1,"offset":0}}
    )


    # Display the first few rows
    pmi_data = pd.DataFrame(data)
    print(pmi_data.head())

    